<Window x:Class="BookshelfConfigurator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:data="clr-namespace:BookshelfConfigurator.Data;assembly=BookshelfConfigurator.Data"
		xmlns:vm="clr-namespace:BookshelfConfigurator.ViewModel;assembly=BookshelfConfigurator.ViewModel"
		xmlns:local="clr-namespace:BookshelfConfigurator"
		xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="MainWindow" Height="600" Width="800">
	<Window.DataContext>
		<local:MainWindowViewModel />
	</Window.DataContext>
	<Window.Resources>
		<ObjectDataProvider ObjectType="{x:Type sys:Enum}"
							MethodName="GetValues" x:Key="WidthValues">
			<ObjectDataProvider.MethodParameters>
				<x:Type Type="{x:Type data:ElementWidth}" />
			</ObjectDataProvider.MethodParameters>
		</ObjectDataProvider>

		<ObjectDataProvider ObjectType="{x:Type sys:Enum}"
							MethodName="GetValues" x:Key="HeightValues">
			<ObjectDataProvider.MethodParameters>
				<x:Type TypeName="data:ElementHeight" />
			</ObjectDataProvider.MethodParameters>
		</ObjectDataProvider>


		<Style TargetType="{x:Type TextBlock}">
			<Setter Property="Margin" Value="0,0,3,0" />
			<Setter Property="VerticalAlignment" Value="Center" />
		</Style>
	</Window.Resources>
	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="*" />
			<ColumnDefinition Width="2*" />
		</Grid.ColumnDefinitions>
		<Grid.RowDefinitions>
			<RowDefinition Height="*" />
			<RowDefinition Height="*" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<DockPanel>
			<Border DockPanel.Dock="Top" Background="LightGray">
				<TextBlock Text="Elements" />
			</Border>
			<ListBox Name="ElementsSelector" ItemsSource="{Binding Path=Shelf.Elements}"
					 HorizontalContentAlignment="Stretch">
				<ListBox.ItemTemplate>
					<DataTemplate>
						<ComboBox ItemsSource="{Binding Source={StaticResource WidthValues}}" 
								  SelectedItem="{Binding Path=Width}" Margin="10,0,0,0"/>
					</DataTemplate>
				</ListBox.ItemTemplate>
			</ListBox>
		</DockPanel>
		<DockPanel Grid.Row="1"> 
			<Border DockPanel.Dock="Top" Background="LightGray">
				<TextBlock Text="Items" />
			</Border>
			<ListBox Name="ItemSelector" ItemsSource="{Binding ElementName=ElementsSelector, Path=SelectedItem.Items}"
					 DisplayMemberPath="Height">
			</ListBox>
		</DockPanel>
		<DockPanel Grid.Row="2">
			<Border DockPanel.Dock="Top" Background="LightGray">
				<TextBlock Text="Items" />
			</Border>
			<Grid DataContext="{Binding ElementName=ItemSelector, Path=SelectedItem}" Margin="3">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="*" />
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>
				
				<TextBlock Text="Width:" />
				<ComboBox Grid.Column="1" SelectedItem="{Binding Path=Width, ValidatesOnDataErrors=True}"
						  ItemsSource="{Binding Source={StaticResource WidthValues}, Mode=OneTime}" />

				<TextBlock Text="Height:" Grid.Row="1" />
				<ComboBox Grid.Column="1" Grid.Row="1" SelectedItem="{Binding Path=Height}"
						  ItemsSource="{Binding Source={StaticResource HeightValues}, Mode=OneTime}"/>
				
				<CheckBox Grid.Row="2" Grid.Column="1" IsChecked="{Binding Path=HasDoor}">Has Door</CheckBox>

				<TextBlock Text="Shelfs:" Grid.Row="3" />
				<TextBox Grid.Column="1" Grid.Row="3" Text="{Binding Path=NumberOfShelfs, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}" />
			</Grid>
		</DockPanel>
		
		<ItemsControl ItemsSource="{Binding Path=Shelf.Elements}" Grid.Column="1" Grid.RowSpan="3"
					  HorizontalAlignment="Center" VerticalAlignment="Center">
			<ItemsControl.ItemsPanel>
				<ItemsPanelTemplate>
					<StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" />
				</ItemsPanelTemplate>
			</ItemsControl.ItemsPanel>
			<ItemsControl.ItemTemplate>
				<DataTemplate>
					<ItemsControl ItemsSource="{Binding Path=Items}" VerticalAlignment="Bottom">
					</ItemsControl>
				</DataTemplate>
			</ItemsControl.ItemTemplate>
		</ItemsControl>
	</Grid>
</Window>
